@page "/search"
@using ImageSearch.Components

@if (_overlayImageId != null)
{
    <Overlay OnOverlayClosed="@(() => { _overlayImageId = null; })">
        <ImageDetail ImageId="@_overlayImageId"/>
    </Overlay>
}

<div class="main">
    <div class="outer-container">
        <img src="logo.png" alt="Logo der Bibliothek St. Moritz"/>

        <div class="inner-container">
            <h1>Bildersuche der Dokumentationsbibliothek St. Moritz</h1>
            <input tabindex="0"
                   class="search-input"
                   @bind="_inputText"
                   placeholder="Bilder suchen..."
                   @bind:event="oninput"
                   @bind:after="@(() => QueueSearch(false))"
                   @onchange="@(() => QueueSearch(true))"/>

            @if (SearchSession.CurrentQuery != null)
            {
                if (SearchSession.TotalImageCount != null)
                {
                    <p>
                        Für die Suche nach @SearchSession.CurrentQuery.ToDescription() wurden @SearchSession.TotalImageCount Bilder gefunden
                        @if (SearchSession.TimeToSearchCount != null)
                        {
                            @($"({Math.Round(SearchSession.TimeToSearchCount.Value.TotalSeconds, 3)} sek)")
                        }
                        @(".")
                    </p>
                    
                }
                else
                {
                    <p>Es wird nach @SearchSession.CurrentQuery.ToDescription() gesucht...</p>
                }
            }
        </div>
    </div>

    <Results OnImageSelected="@OnImageSelected"/>
</div>